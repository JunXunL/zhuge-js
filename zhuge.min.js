!function(){var t=Array.prototype,e=Object.prototype,n=t.slice,i=e.toString,r=e.hasOwnProperty,o=window.console,s=window.navigator,a=window.document,c=s.userAgent,u={},f="1.1",p="https:"==a.location.protocol?"https://":"http://",h=window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,d=!1,l={api_host:p+"apipool.37degree.com/web_event/?method=web_event_srv.upload",ping_host:p+"apipool.37degree.com/web_event/?method=ping",debug:!1,ping:!1,ping_interval:12e3,idle_timeout:3e5,idle_threshold:1e4,track_link_timeout:300,cookie_expire_days:365,cookie_cross_subdomain:!0,cookie_secure:!1,info_upload_interval_days:7,session_interval_mins:30,app_channel:"web",app_version:"1.0"};!function(){var e=t.forEach,o=Array.isArray,s={};u.each=function(t,n,i){if(null!=t)if(e&&t.forEach===e)t.forEach(n,i);else if(t.length===+t.length){for(var o=0,a=t.length;a>o;o++)if(o in t&&n.call(i,t[o],o,t)===s)return}else for(var c in t)if(r.call(t,c)&&n.call(i,t[c],c,t)===s)return},u.extend=function(t){return u.each(n.call(arguments,1),function(e){for(var n in e)void 0!==e[n]&&(t[n]=e[n])}),t},u.isUndefined=function(t){return void 0===t},u.isString=function(t){return"[object String]"==i.call(t)},u.isArray=o||function(t){return"[object Array]"===i.call(t)},u.isFunction=function(t){try{return/^\s*\bfunction\b/.test(t)}catch(e){return!1}},u.isObject=function(t){return t===Object(t)&&!u.isArray(t)},u.includes=function(t,e){return-1!==t.indexOf(e)}}(),u.truncate=function(t,e){var n;return"string"==typeof t?n=t.slice(0,e):u.isArray(t)?(n=[],u.each(t,function(t){n.push(u.truncate(t,e))})):u.isObject(t)?(n={},u.each(t,function(t,i){n[i]=u.truncate(t,e)})):n=t,n},u.strip_empty_properties=function(t){var e={};return u.each(t,function(t,n){u.isString(t)&&t.length>0&&(e[n]=t)}),e},u.JSONEncode=function(){return function(t){var e=t,n=function(t){var e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,n={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return e.lastIndex=0,e.test(t)?'"'+t.replace(e,function(t){var e=n[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'},o=function(t,e){var s="",a="    ",c=0,u="",f="",p=0,h=s,d=[],l=e[t];switch(l&&"object"==typeof l&&"function"==typeof l.toJSON&&(l=l.toJSON(t)),typeof l){case"string":return n(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";if(s+=a,d=[],"[object Array]"===i.apply(l)){for(p=l.length,c=0;p>c;c+=1)d[c]=o(c,l)||"null";return f=0===d.length?"[]":s?"[\n"+s+d.join(",\n"+s)+"\n"+h+"]":"["+d.join(",")+"]",s=h,f}for(u in l)r.call(l,u)&&(f=o(u,l),f&&d.push(n(u)+(s?": ":":")+f));return f=0===d.length?"{}":s?"{"+d.join(",")+h+"}":"{"+d.join(",")+"}",s=h,f}};return o("",{"":e})}}(),u.JSONDecode=function(){var t,e,n,i,r={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"	"},o=function(e){throw{name:"SyntaxError",message:e,at:t,text:n}},s=function(i){return i&&i!==e&&o("Expected '"+i+"' instead of '"+e+"'"),e=n.charAt(t),t+=1,e},a=function(){var t,n="";for("-"===e&&(n="-",s("-"));e>="0"&&"9">=e;)n+=e,s();if("."===e)for(n+=".";s()&&e>="0"&&"9">=e;)n+=e;if("e"===e||"E"===e)for(n+=e,s(),("-"===e||"+"===e)&&(n+=e,s());e>="0"&&"9">=e;)n+=e,s();return t=+n,isFinite(t)?t:void o("Bad number")},c=function(){var t,n,i,a="";if('"'===e)for(;s();){if('"'===e)return s(),a;if("\\"===e)if(s(),"u"===e){for(i=0,n=0;4>n&&(t=parseInt(s(),16),isFinite(t));n+=1)i=16*i+t;a+=String.fromCharCode(i)}else{if("string"!=typeof r[e])break;a+=r[e]}else a+=e}o("Bad string")},u=function(){for(;e&&" ">=e;)s()},f=function(){switch(e){case"t":return s("t"),s("r"),s("u"),s("e"),!0;case"f":return s("f"),s("a"),s("l"),s("s"),s("e"),!1;case"n":return s("n"),s("u"),s("l"),s("l"),null}o("Unexpected '"+e+"'")},p=function(){var t=[];if("["===e){if(s("["),u(),"]"===e)return s("]"),t;for(;e;){if(t.push(i()),u(),"]"===e)return s("]"),t;s(","),u()}}o("Bad array")},h=function(){var t,n={};if("{"===e){if(s("{"),u(),"}"===e)return s("}"),n;for(;e;){if(t=c(),u(),s(":"),Object.hasOwnProperty.call(n,t)&&o('Duplicate key "'+t+'"'),n[t]=i(),u(),"}"===e)return s("}"),n;s(","),u()}}o("Bad object")};return i=function(){switch(u(),e){case"{":return h();case"[":return p();case'"':return c();case"-":return a();default:return e>="0"&&"9">=e?a():f()}},function(r){var s;return n=r,t=0,e=" ",s=i(),u(),e&&o("Syntax error"),s}}(),u.HTTPBuildQuery=function(t,e){var n,i,r=[];return"undefined"==typeof e&&(e="&"),u.each(t,function(t,e){n=encodeURIComponent(t.toString()),i=encodeURIComponent(e),r[r.length]=i+"="+n}),r.join(e)},u.register_event=function(){function t(t,n,i){var r=function(r){if(r=r||e(window.event),!r)return void 0;var o,s,a=!0;return u.isFunction(i)&&(o=i(r)),s=n.call(t,r),(!1===o||!1===s)&&(a=!1),a};return r}function e(t){return t&&(t.preventDefault=e.preventDefault,t.stopPropagation=e.stopPropagation),t}var n=function(e,n,i,r){if(!e)return void g.error("No valid element provided to register_event");if(e.addEventListener&&!r)e.addEventListener(n,i,!1);else{var o="on"+n,s=e[o];e[o]=t(e,i,s)}};return e.preventDefault=function(){this.returnValue=!1},e.stopPropagation=function(){this.cancelBubble=!0},n}(),u.cookie={get:function(t){for(var e=t+"=",n=a.cookie.split(";"),i=0;i<n.length;i++){for(var r=n[i];" "==r.charAt(0);)r=r.substring(1,r.length);if(0==r.indexOf(e))return decodeURIComponent(r.substring(e.length,r.length))}return null},parse:function(t){var e;try{e=u.JSONDecode(u.cookie.get(t))||{}}catch(n){}return e},set:function(t,e,n,i,r){var o="",s="",c="";if(i){var u=a.location.hostname.match(/[a-z0-9][a-z0-9\-]+\.[a-z\.]{2,6}$/i),f=u?u[0]:"";o=f?"; domain=."+f:""}if(n){var p=new Date;p.setTime(p.getTime()+24*n*60*60*1e3),s="; expires="+p.toGMTString()}r&&(c="; secure"),a.cookie=t+"="+encodeURIComponent(e)+s+"; path=/"+o+c},remove:function(t,e){u.cookie.set(t,"",-1,e)}},u.UUID=function(){var t=function(){for(var t=1*new Date,e=0;t==1*new Date;)e++;return t.toString(16)+e.toString(16)},e=function(){return Math.random().toString(16).replace(".","")},n=function(){function t(t,e){var n,i=0;for(n=0;n<e.length;n++)i|=r[n]<<8*n;return t^i}var e,n,i=c,r=[],o=0;for(e=0;e<i.length;e++)n=i.charCodeAt(e),r.unshift(255&n),r.length>=4&&(o=t(o,r),r=[]);return r.length>0&&(o=t(o,r)),o.toString(16)};return function(){var i=(screen.height*screen.width).toString(16);return t()+"-"+e()+"-"+n()+"-"+i+"-"+t()}}(),u.info={browser:function(t,e,n){var e=e||"";return n?u.includes(t,"Mini")?"Opera Mini":"Opera":/(BlackBerry|PlayBook|BB10)/i.test(t)?"BlackBerry":u.includes(t,"FBIOS")?"Facebook Mobile":u.includes(t,"Chrome")?"Chrome":u.includes(t,"CriOS")?"Chrome iOS":u.includes(e,"Apple")?u.includes(t,"Mobile")?"Mobile Safari":"Safari":u.includes(t,"Android")?"Android Mobile":u.includes(t,"Konqueror")?"Konqueror":u.includes(t,"Firefox")?"Firefox":u.includes(t,"MSIE")||u.includes(t,"Trident/")?"Internet Explorer":u.includes(t,"Gecko")?"Mozilla":""},os:function(){var t=c;return/Windows/i.test(t)?/Phone/.test(t)?"Windows Mobile":"Windows":/(iPhone|iPad|iPod)/.test(t)?"iOS":/Android/.test(t)?"Android":/(BlackBerry|PlayBook|BB10)/i.test(t)?"BlackBerry":/Mac/i.test(t)?"Mac OS X":/Linux/.test(t)?"Linux":""},device:function(t){return/iPad/.test(t)?"iPad":/iPod/.test(t)?"iPod Touch":/iPhone/.test(t)?"iPhone":/(BlackBerry|PlayBook|BB10)/i.test(t)?"BlackBerry":/Windows Phone/i.test(t)?"Windows Phone":/Android/.test(t)?"Android":""},resolution:function(){return screen.width+"*"+screen.height},properties:function(){return u.strip_empty_properties({os:u.info.os(),br:u.info.browser(c,s.vendor,window.opera),dv:u.info.device(c),rs:u.info.resolution()})}};var g={log:function(){if(d&&!u.isUndefined(o)&&o)try{o.log.apply(o,arguments)}catch(t){u.each(arguments,function(t){o.log(t)})}},error:function(){if(d&&!u.isUndefined(o)&&o){var t=["Zhuge error:"].concat(u.toArray(arguments));try{o.error.apply(o,t)}catch(e){u.each(t,function(t){o.error(t)})}}}},v=function(t){this.name="_zg",this.props={},this.config=u.extend({},t),this.load()};v.prototype.load=function(){var t=u.cookie.parse(this.name);t&&(this.props=u.extend({},t))},v.prototype.save=function(){u.cookie.set(this.name,u.JSONEncode(this.props),this.config.cookie_expire_days,this.config.cookie_cross_subdomain,this.config.cookie_secure)},v.prototype.register_once=function(t,e){return u.isObject(t)?("undefined"==typeof e&&(e="None"),u.each(t,function(t,n){this.props[n]&&this.props[n]!==e||(this.props[n]=t)},this),this.save(),!0):!1},v.prototype.register=function(t){return u.isObject(t)?(u.extend(this.props,t),this.save(),!0):!1};var _=function(){this.config={},u.extend(this.config,l),this.idle=0,this.last_activity=new Date};_.prototype._init=function(t,e){this._key=t,this._jsc=function(){},u.isObject(e)&&(u.extend(this.config,e),d=d||this.config.debug),this.cookie=new v(this.config),this.cookie.register_once({uuid:u.UUID(),sid:0,updated:0,info:0},""),this._session(),this._info(),this._startPing()},_.prototype._session=function(){var t=this.cookie.props.updated,e=this.cookie.props.sid,n=parseInt(1*new Date/1e3);if(0==e||n>t+60*this.config.session_interval_mins){if(e>0&&t>0){var i={};i.et="se",i.sid=e,i.dr=t-e,this._batchTrack(i)}var r={};r.et="ss",r.sid=n,r.pr=u.extend(u.info.properties(),{cn:this.config.app_channel,vn:this.config.app_version}),this._batchTrack(r),this.cookie.register({sid:n},"")}this.cookie.register({updated:n},"")},_.prototype._info=function(){var t=this.cookie.props.info,e=1*new Date;if(e>t+24*this.config.info_upload_interval_days*60*60*1e3){var n={};n.et="info",n.pr=u.extend(u.info.properties(),{cn:this.config.app_channel,vn:this.config.app_version}),this._batchTrack(n),this.cookie.register({info:e},"")}},_.prototype.debug=function(t){d=t},_.prototype.identify=function(t,e,n){this._session();var i={};i.et="idf",i.cuid=t,i.pr=e,i.sid=this.cookie.props.sid,this._batchTrack(i,n)},_.prototype.page=function(t,e){this._session();var n=a.location.href,i={};i.et="pg",i.pid=n,i.pn="undefined"==typeof t?n:t,i.tl=a.title,i.ref=a.referrer,i.sid=this.cookie.props.sid,this._batchTrack(i,e)},_.prototype.track=function(t,e,n){this._session();var i={};i.et="cus",i.eid=t,i.pr=e,i.sid=this.cookie.props.sid,this._batchTrack(i,n)},_.prototype.trackLink=function(t,e,n){if(!t)return this;u.isArray(t)||(t=[t]);var i=this;return u.each(t,function(t){var r=function(r){i.track(e,n),t.href&&"_blank"!==t.target&&!r.metaKey&&2!==r.which&&(r.preventDefault(),window.setTimeout(function(){window.location.href=t.href},this.config.track_link_timeout))};u.register_event(t,"click",r)}),this},_.prototype.trackForm=function(t,e,n){if(!t)return this;u.isArray(t)||(t=[t]);var i=this;return u.each(t,function(t){var r=function(r){r.preventDefault(),i.track(e,n),window.setTimeout(function(){t.submit()},TRACK_LINK_TIMEOUT)},o=window.jQuery||window.Zepto;o?o(t).submit(r):u.register_event(t,"submit",r)}),this},_.prototype._moved=function(){this.last_activity=new Date,this.idle=0},_.prototype._startPing=function(){var t=this;u.register_event(window,"mousemove",function(){t._moved.apply(t,arguments)}),"undefined"==typeof this.pingInterval&&(this.pingInterval=window.setInterval(function(){t._ping()},this.config.ping_interval))},_.prototype._stopPing=function(){"undefined"!=typeof this.pingInterval&&(window.clearInterval(this.pingInterval),delete this.pingInterval)},_.prototype._ping=function(){if(this.config.ping&&this.idle<this.config.idle_timeout){g.log("ZHUGE PING");var t=this.config.ping_host+"?_="+(new Date).getTime().toString()+"&ak="+this._key+"&did="+this.cookie.props.uuid;this._sendRequest(t)}else this._stopPing();var e=new Date;return e-this.last_activity>this.config.idle_threshold&&(this.idle=e-this.last_activity),this},_.prototype._batchTrack=function(t,e){var n={};n.type="statis",n.sdk="web",n.sdkv=f,n.ak=this._key,n.did=this.cookie.props.uuid;var i=[];i.push(t),n.data=i,this._sendTrackRequest(n,this._prepareCallback(e,n))},_.prototype._prepareCallback=function(t,e){if(u.isUndefined(t))return null;if(h){var n=function(n){t(n,e)};return n}var i=this._jsc,r=""+Math.floor(1e8*Math.random()),o='zhuge_jsc["'+r+'"]';return i[r]=function(n){delete i[r],t(n,e)},o},_.prototype._sendTrackRequest=function(t,e){var n=u.truncate(t,255),i=u.JSONEncode(n);g.log("ZHUGE REQUEST DATA:"),g.log(n),data={event:i,_:(new Date).getTime().toString()};var r=this.config.api_host+"&"+u.HTTPBuildQuery(data);this._sendRequest(r,e)},_.prototype._sendRequest=function(t,e){if(h){var n=new XMLHttpRequest;n.open("GET",t,!0),n.withCredentials=!0,n.onreadystatechange=function(){if(4===n.readyState){if(200!==n.status){var t="Bad HTTP status: "+n.status+" "+n.statusText;g.error(t)}e&&e(n.status)}},n.send(null)}else{var i=a.createElement("script");i.type="text/javascript",i.async=!0,i.defer=!0,i.src=t;var r=a.getElementsByTagName("script")[0];r.parentNode.insertBefore(i,r)}},_.prototype.push=function(t){var e=t.shift();this[e]&&this[e].apply(this,t)};for(var y=window.zhuge||[],k=new _;y&&y.length>0;){var w=y.shift(),b=w.shift();k[b]&&k[b].apply(k,w)}window.zhuge=k}();