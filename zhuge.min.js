(function(){var e=Array.prototype,t=Object.prototype,n=e.slice,r=t.toString,i=t.hasOwnProperty,s=window.console,o=window.navigator,u=window.document,a=o.userAgent;var f={},l="1.1",c="https:"==u.location.protocol?"https://":"http://",h=window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,p=false,d={api_host:c+"apipool.37degree.com/web_event/?method=web_event_srv.upload",debug:false,ping:false,ping_interval:12e3,idle_timeout:3e5,idle_threshold:1e4,track_link_timeout:300,cookie_expire_days:365,cookie_cross_subdomain:true,cookie_secure:false,info_upload_interval_days:7,session_interval_mins:30,app_channel:"web",app_version:"1.0"};(function(){var t=e.forEach,s=Array.isArray,o={};f.each=function(e,n,r){if(e==null)return;if(t&&e.forEach===t){e.forEach(n,r)}else if(e.length===+e.length){for(var s=0,u=e.length;s<u;s++){if(s in e&&n.call(r,e[s],s,e)===o)return}}else{for(var a in e){if(i.call(e,a)){if(n.call(r,e[a],a,e)===o)return}}}};f.extend=function(e){f.each(n.call(arguments,1),function(t){for(var n in t){if(t[n]!==void 0)e[n]=t[n]}});return e};f.isUndefined=function(e){return e===void 0};f.isString=function(e){return r.call(e)=="[object String]"};f.isArray=s||function(e){return r.call(e)==="[object Array]"};f.isFunction=function(e){try{return/^\s*\bfunction\b/.test(e)}catch(t){return false}};f.isObject=function(e){return e===Object(e)&&!f.isArray(e)};f.includes=function(e,t){return e.indexOf(t)!==-1}})();f.truncate=function(e,t){var n;if(typeof e==="string"){n=e.slice(0,t)}else if(f.isArray(e)){n=[];f.each(e,function(e){n.push(f.truncate(e,t))})}else if(f.isObject(e)){n={};f.each(e,function(e,r){n[r]=f.truncate(e,t)})}else{n=e}return n};f.strip_empty_properties=function(e){var t={};f.each(e,function(e,n){if(f.isString(e)&&e.length>0){t[n]=e}});return t};f.JSONEncode=function(){return function(e){var t;var n=e;var s;var o=function(e){var t=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;var n={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};t.lastIndex=0;return t.test(e)?'"'+e.replace(t,function(e){var t=n[e];return typeof t==="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'};var u=function(e,t){var n="";var s="    ";var a=0;var f="";var l="";var c=0;var h=n;var p=[];var d=t[e];if(d&&typeof d==="object"&&typeof d.toJSON==="function"){d=d.toJSON(e)}switch(typeof d){case"string":return o(d);case"number":return isFinite(d)?String(d):"null";case"boolean":case"null":return String(d);case"object":if(!d){return"null"}n+=s;p=[];if(r.apply(d)==="[object Array]"){c=d.length;for(a=0;a<c;a+=1){p[a]=u(a,d)||"null"}l=p.length===0?"[]":n?"[\n"+n+p.join(",\n"+n)+"\n"+h+"]":"["+p.join(",")+"]";n=h;return l}for(f in d){if(i.call(d,f)){l=u(f,d);if(l){p.push(o(f)+(n?": ":":")+l)}}}l=p.length===0?"{}":n?"{"+p.join(",")+""+h+"}":"{"+p.join(",")+"}";n=h;return l}};return u("",{"":n})}}();f.JSONDecode=function(){var e,t,n={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"	"},r,i=function(t){throw{name:"SyntaxError",message:t,at:e,text:r}},s=function(n){if(n&&n!==t){i("Expected '"+n+"' instead of '"+t+"'")}t=r.charAt(e);e+=1;return t},o=function(){var e,n="";if(t==="-"){n="-";s("-")}while(t>="0"&&t<="9"){n+=t;s()}if(t==="."){n+=".";while(s()&&t>="0"&&t<="9"){n+=t}}if(t==="e"||t==="E"){n+=t;s();if(t==="-"||t==="+"){n+=t;s()}while(t>="0"&&t<="9"){n+=t;s()}}e=+n;if(!isFinite(e)){i("Bad number")}else{return e}},u=function(){var e,r,o="",u;if(t==='"'){while(s()){if(t==='"'){s();return o}if(t==="\\"){s();if(t==="u"){u=0;for(r=0;r<4;r+=1){e=parseInt(s(),16);if(!isFinite(e)){break}u=u*16+e}o+=String.fromCharCode(u)}else if(typeof n[t]==="string"){o+=n[t]}else{break}}else{o+=t}}}i("Bad string")},a=function(){while(t&&t<=" "){s()}},f=function(){switch(t){case"t":s("t");s("r");s("u");s("e");return true;case"f":s("f");s("a");s("l");s("s");s("e");return false;case"n":s("n");s("u");s("l");s("l");return null}i("Unexpected '"+t+"'")},l,c=function(){var e=[];if(t==="["){s("[");a();if(t==="]"){s("]");return e}while(t){e.push(l());a();if(t==="]"){s("]");return e}s(",");a()}}i("Bad array")},h=function(){var e,n={};if(t==="{"){s("{");a();if(t==="}"){s("}");return n}while(t){e=u();a();s(":");if(Object.hasOwnProperty.call(n,e)){i('Duplicate key "'+e+'"')}n[e]=l();a();if(t==="}"){s("}");return n}s(",");a()}}i("Bad object")};l=function(){a();switch(t){case"{":return h();case"[":return c();case'"':return u();case"-":return o();default:return t>="0"&&t<="9"?o():f()}};return function(n){var s;r=n;e=0;t=" ";s=l();a();if(t){i("Syntax error")}return s}}();f.HTTPBuildQuery=function(e,t){var n,r,i,s=[];if(typeof t==="undefined"){t="&"}f.each(e,function(e,t){r=encodeURIComponent(e.toString());i=encodeURIComponent(t);s[s.length]=i+"="+r});return s.join(t)};f.register_event=function(){function t(e,t,r){var i=function(i){i=i||n(window.event);if(!i){return undefined}var s=true;var o,u;if(f.isFunction(r)){o=r(i)}u=t.call(e,i);if(false===o||false===u){s=false}return s};return i}function n(e){if(e){e.preventDefault=n.preventDefault;e.stopPropagation=n.stopPropagation}return e}var e=function(e,n,r,i){if(!e){v.error("No valid element provided to register_event");return}if(e.addEventListener&&!i){e.addEventListener(n,r,false)}else{var s="on"+n;var o=e[s];e[s]=t(e,r,o)}};n.preventDefault=function(){this.returnValue=false};n.stopPropagation=function(){this.cancelBubble=true};return e}();f.cookie={get:function(e){var t=e+"=";var n=u.cookie.split(";");for(var r=0;r<n.length;r++){var i=n[r];while(i.charAt(0)==" ")i=i.substring(1,i.length);if(i.indexOf(t)==0)return decodeURIComponent(i.substring(t.length,i.length))}return null},parse:function(e){var t;try{t=f.JSONDecode(f.cookie.get(e))||{}}catch(n){}return t},set:function(e,t,n,r,i){var s="",o="",a="";if(r){var f=u.location.hostname.match(/[a-z0-9][a-z0-9\-]+\.[a-z\.]{2,6}$/i),l=f?f[0]:"";s=l?"; domain=."+l:""}if(n){var c=new Date;c.setTime(c.getTime()+n*24*60*60*1e3);o="; expires="+c.toGMTString()}if(i){a="; secure"}u.cookie=e+"="+encodeURIComponent(t)+o+"; path=/"+s+a},remove:function(e,t){f.cookie.set(e,"",-1,t)}};f.UUID=function(){var e=function(){var e=1*new Date,t=0;while(e==1*new Date){t++}return e.toString(16)+t.toString(16)};var t=function(){return Math.random().toString(16).replace(".","")};var n=function(e){function o(e,t){var n,r=0;for(n=0;n<t.length;n++){r|=i[n]<<n*8}return e^r}var t=a,n,r,i=[],s=0;for(n=0;n<t.length;n++){r=t.charCodeAt(n);i.unshift(r&255);if(i.length>=4){s=o(s,i);i=[]}}if(i.length>0){s=o(s,i)}return s.toString(16)};return function(){var r=(screen.height*screen.width).toString(16);return e()+"-"+t()+"-"+n()+"-"+r+"-"+e()}}();f.info={browser:function(e,t,n){var t=t||"";if(n){if(f.includes(e,"Mini")){return"Opera Mini"}return"Opera"}else if(/(BlackBerry|PlayBook|BB10)/i.test(e)){return"BlackBerry"}else if(f.includes(e,"FBIOS")){return"Facebook Mobile"}else if(f.includes(e,"Chrome")){return"Chrome"}else if(f.includes(e,"CriOS")){return"Chrome iOS"}else if(f.includes(t,"Apple")){if(f.includes(e,"Mobile")){return"Mobile Safari"}return"Safari"}else if(f.includes(e,"Android")){return"Android Mobile"}else if(f.includes(e,"Konqueror")){return"Konqueror"}else if(f.includes(e,"Firefox")){return"Firefox"}else if(f.includes(e,"MSIE")||f.includes(e,"Trident/")){return"Internet Explorer"}else if(f.includes(e,"Gecko")){return"Mozilla"}else{return""}},os:function(){var e=a;if(/Windows/i.test(e)){if(/Phone/.test(e)){return"Windows Mobile"}return"Windows"}else if(/(iPhone|iPad|iPod)/.test(e)){return"iOS"}else if(/Android/.test(e)){return"Android"}else if(/(BlackBerry|PlayBook|BB10)/i.test(e)){return"BlackBerry"}else if(/Mac/i.test(e)){return"Mac OS X"}else if(/Linux/.test(e)){return"Linux"}else{return""}},device:function(e){if(/iPad/.test(e)){return"iPad"}else if(/iPod/.test(e)){return"iPod Touch"}else if(/iPhone/.test(e)){return"iPhone"}else if(/(BlackBerry|PlayBook|BB10)/i.test(e)){return"BlackBerry"}else if(/Windows Phone/i.test(e)){return"Windows Phone"}else if(/Android/.test(e)){return"Android"}else{return""}},resolution:function(){return screen.width+"*"+screen.height},properties:function(){return f.strip_empty_properties({os:f.info.os(),br:f.info.browser(a,o.vendor,window.opera),dv:f.info.device(a),rs:f.info.resolution()})}};var v={log:function(){if(p&&!f.isUndefined(s)&&s){try{s.log.apply(s,arguments)}catch(e){f.each(arguments,function(e){s.log(e)})}}},error:function(){if(p&&!f.isUndefined(s)&&s){var e=["Zhuge error:"].concat(f.toArray(arguments));try{s.error.apply(s,e)}catch(t){f.each(e,function(e){s.error(e)})}}}};var m=function(e){this.name="_zg";this["props"]={};this["config"]=f.extend({},e);this.load()};m.prototype.load=function(){var e=f.cookie.parse(this.name);if(e){this["props"]=f.extend({},e)}};m.prototype.save=function(){f.cookie.set(this.name,f.JSONEncode(this["props"]),this["config"]["cookie_expire_days"],this["config"]["cookie_cross_subdomain"],this["config"]["cookie_secure"])};m.prototype.register_once=function(e,t){if(f.isObject(e)){if(typeof t==="undefined"){t="None"}f.each(e,function(e,n){if(!this["props"][n]||this["props"][n]===t){this["props"][n]=e}},this);this.save();return true}return false};m.prototype.register=function(e){if(f.isObject(e)){f.extend(this["props"],e);this.save();return true}return false};var g=function(){this["config"]={};f.extend(this["config"],d);this.idle=0;this.last_activity=new Date};g.prototype._init=function(e,t){this._key=e;this["_jsc"]=function(){};if(f.isObject(t)){f.extend(this["config"],t);p=p||this["config"]["debug"]}this["cookie"]=new m(this["config"]);this["cookie"].register_once({uuid:f.UUID(),sid:0,updated:0,info:0},"");this._session();this._info();this._startPing()};g.prototype._session=function(){var e=this["cookie"]["props"]["updated"];var t=this["cookie"]["props"]["sid"];var n=parseInt(1*new Date/1e3);if(t==0||n>e+this["config"]["session_interval_mins"]*60){if(t>0&&e>0){var r={};r.et="se";r.sid=t;r.dr=e-t;this._batchTrack(r)}var i={};i.et="ss";i.sid=n;i.pr=f.extend(f.info.properties(),{cn:this["config"]["app_channel"],vn:this["config"]["app_version"]});this._batchTrack(i);this["cookie"].register({sid:n},"")}this["cookie"].register({updated:n},"")};g.prototype._info=function(){var e=this["cookie"]["props"]["info"];var t=1*new Date;if(t>e+this["config"]["info_upload_interval_days"]*24*60*60*1e3){var n={};n.et="info";n.pr=f.extend(f.info.properties(),{cn:this["config"]["app_channel"],vn:this["config"]["app_version"]});this._batchTrack(n);this["cookie"].register({info:t},"")}};g.prototype.debug=function(e){p=e};g.prototype.identify=function(e,t,n){this["cookie"].register({cuid:e},"");this._session();var r={};r.et="idf";r.cuid=e;r.pr=t;r.sid=this["cookie"]["props"]["sid"];this._batchTrack(r,n)};g.prototype.page=function(e,t){this._session();var n=u.location.href;var r={};r.et="pg";r.pid=n;r.pn=typeof e==="undefined"?n:e;r.tl=u.title;r.ref=u.referrer;r.sid=this["cookie"]["props"]["sid"];this._batchTrack(r,t)};g.prototype.track=function(e,t,n){this._session();var r={};r.et="cus";r.eid=e;r.pr=t;r.sid=this["cookie"]["props"]["sid"];this._batchTrack(r,n)};g.prototype.trackLink=function(e,t,n){if(!e)return this;if(!f.isArray(e))e=[e];var r=this;f.each(e,function(e){var i=function(i){r.track(t,n);if(e.href&&e.target!=="_blank"&&!i.metaKey&&i.which!==2){i.preventDefault();window.setTimeout(function(){window.location.href=e.href},this["config"]["track_link_timeout"])}};f.register_event(e,"click",i)});return this};g.prototype.trackForm=function(e,t,n){if(!e)return this;if(!f.isArray(e))e=[e];var r=this;f.each(e,function(e){var i=function(i){i.preventDefault();r.track(t,n);window.setTimeout(function(){e.submit()},TRACK_LINK_TIMEOUT)};var s=window.jQuery||window.Zepto;if(s){s(e).submit(i)}else{f.register_event(e,"submit",i)}});return this};g.prototype._moved=function(e){this.last_activity=new Date;this.idle=0};g.prototype._startPing=function(){var e=this;f.register_event(window,"mousemove",function(){e._moved.apply(e,arguments)});if(typeof this.pingInterval==="undefined"){this.pingInterval=window.setInterval(function(){e._ping()},this["config"]["ping_interval"])}};g.prototype._stopPing=function(){if(typeof this.pingInterval!=="undefined"){window.clearInterval(this.pingInterval);delete this.pingInterval}};g.prototype._ping=function(){if(this["config"]["ping"]&&this.idle<this["config"]["idle_timeout"]){var e={};e.type="ping";e.sdk="web";e.sdkv=l;e.ak=this._key;e.did=this["cookie"]["props"]["uuid"];e.cuid=this["cookie"]["props"]["cuid"];this._sendTrackRequest(e)}else{this._stopPing()}var t=new Date;if(t-this.last_activity>this["config"]["idle_threshold"]){this.idle=t-this.last_activity}return this};g.prototype._batchTrack=function(e,t){var n={};n.type="statis";n.sdk="web";n.sdkv=l;n.ak=this._key;n.did=this["cookie"]["props"]["uuid"];n.cuid=this["cookie"]["props"]["cuid"];var r=[];r.push(e);n.data=r;this._sendTrackRequest(n,this._prepareCallback(t,n))};g.prototype._prepareCallback=function(e,t){if(f.isUndefined(e)){return null}if(h){var n=function(n){e(n,t)};return n}else{var r=this["_jsc"],i=""+Math.floor(Math.random()*1e8),s='zhuge_jsc["'+i+'"]';r[i]=function(n){delete r[i];e(n,t)};return s}};g.prototype._sendTrackRequest=function(e,t){var n=f.truncate(e,255),r=f.JSONEncode(n);v.log("ZHUGE REQUEST DATA:");v.log(n);data={event:r,_:(new Date).getTime().toString()};var i=this["config"]["api_host"]+"&"+f.HTTPBuildQuery(data);this._sendRequest(i,t)};g.prototype._sendRequest=function(e,t){if(h){var n=new XMLHttpRequest;n.open("GET",e,true);n.withCredentials=true;n.onreadystatechange=function(e){if(n.readyState===4){if(n.status!==200){var r="Bad HTTP status: "+n.status+" "+n.statusText;v.error(r)}if(t)t(n.status)}};n.send(null)}else{var r=u.createElement("script");r.type="text/javascript";r.async=true;r.defer=true;r.src=e;var i=u.getElementsByTagName("script")[0];i.parentNode.insertBefore(r,i)}};g.prototype.push=function(e){var t=e.shift();if(!this[t])return;this[t].apply(this,e)};var y=window.zhuge||[];var b=new g;while(y&&y.length>0){var w=y.shift();var E=w.shift();if(b[E])b[E].apply(b,w)}window.zhuge=b})()