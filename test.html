<!DOCTYPE html>
<html lang="zh-cn">

<head>
    <meta charset="utf8">
    <title>Zhuge Test</title>
    <script type="text/javascript">
    window.zhuge = window.zhuge || [];

    window.zhuge.methods = ['_init', 'debug', 'identify', 'track', 'trackLink', 'trackForm', 'page'];

    window.zhuge.factory = function(method) {
        return function() {
            var args = Array.prototype.slice.call(arguments);
            args.unshift(method);
            window.zhuge.push(args);
            return window.zhuge;
        };
    };


    for (var i = 0; i < window.zhuge.methods.length; i++) {
        var key = window.zhuge.methods[i];
        window.zhuge[key] = window.zhuge.factory(key);
    }

    window.zhuge.load = function(key, config) {
        if (document.getElementById('zhuge-js')) return;

        var script = document.createElement('script');
        script.type = 'text/javascript';
        script.id = 'zhuge-js';
        script.async = true;
        script.src = 'zhuge.js';

        var first = document.getElementsByTagName('script')[0];
        first.parentNode.insertBefore(script, first);

        window.zhuge._init(key, config);
    };

    var config = {
        session_interval_mins:30,
        app_version:1.2,
        app_channel:'referrer test'
    };
    window.zhuge.load('5f8a935cd15a47419df0e07d0547551b', config);
    zhuge.track('测试乱码');

    </script>

</head>

<body>
</body>

</html>
